#!/usr/bin/env node

'use strict'

const path = require('path')
const sass = require('node-sass')
const {digestPath} = require('../assets')
const {STATIC_ORIGIN} = process.env

console.log(sass.renderSync({
  file: process.argv[2],
  outputStyle: 'compressed',
  functions: {
    'asset-path($file)': (file) => {
      const url = digestPath(file.getValue())
      return new sass.types.String(`url('${path.join(STATIC_ORIGIN || '/', url)}')`)
    }
  }
}).css.toString())
