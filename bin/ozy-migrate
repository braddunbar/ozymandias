#!/usr/bin/env node

'use strict'

const db = require('../db/instance')
const path = require('path')
const migrate = require('../migrate')

;(async () => {
  db.log = () => {}
  const transaction = db.transaction()
  db.query = transaction.query.bind(transaction)

  try {
    await migrate(path.resolve(__dirname, '../migrate'))
    await migrate('./migrate')
    await transaction.commit()
    db.close()
  } catch (error) {
    console.error(error.message)
    process.exit(1)
  }
})()
